# MTL-FinBERT  
---


## ğŸ“Œ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯è®ºæ–‡ã€ŠMTL-FinBERTï¼šæ•°å­—é‡‘èç”Ÿæ€ç³»ç»Ÿä¸­å¼‚æ„é‡‘èæ–‡æœ¬æƒ…æ„Ÿåˆ†æçš„å¤šä»»åŠ¡å­¦ä¹ æ¡†æ¶ã€‹çš„é…å¥—ä»£ç ã€‚  
æ—¨åœ¨é€šè¿‡ä½œè€…æå‡ºçš„å¤šä»»åŠ¡å­¦ä¹  çš„ FinBERT æ¶æ„ï¼Œæå‡é‡‘èå¸‚åœºä¸­è·¨æ¨¡æ€ã€å¼‚è´¨åŒ–æ–‡æœ¬æƒ…æ„Ÿåˆ†æçš„å‡†ç¡®æ€§å’Œå¯æ‰©å±•æ€§ã€‚


---
## âœ¨ æŠ€æœ¯ä»‹ç»
æœ¬é¡¹ç›®æ·±åº¦å­¦ä¹ æƒ…ç»ªæµ‹åº¦éƒ¨åˆ†åŸºäºpytorchæ¶æ„ä»¥åŠFinBERTé¢„è®­ç»ƒï¼Œè¿›è¡Œç½‘ç»œç»“æ„å‡çº§ï¼Œ
æ¶æ„é€šè¿‡åº•å±‚ç‰¹å¾æå–å±‚ï¼ˆæ•æ‰å¼‚è´¨æ–‡æœ¬å…±æ€§ç‰¹å¾ï¼‰ä¸ä»»åŠ¡ç‰¹å®šå±‚ï¼ˆä¿ç•™æ•°æ®æºç‰¹å¼‚æ€§ï¼‰ï¼Œ
å†èåˆè·¨æ–‡æœ¬å…±äº«æœºåˆ¶å»å¢åŠ å…³è”è¿›è¡Œå¤šç›®æ ‡ååŒä¼˜åŒ–ã€‚  

åŒæ—¶ä¸ºå¯¹æ¯”æœ¬æ¨¡å‹çš„æ•ˆæœï¼Œæœ¬æ–‡å…±æå‡ºä¸‰ç±»æ¨¡å‹å…±å…«ç§æƒ…ç»ªæµ‹åº¦æ–¹æ³•è¿›è¡Œå¯¹æ¯”ï¼Œåˆ†åˆ«æ˜¯ï¼š  
- å­—å…¸æ³•ï¼šDLUTã€Bianã€Jiang  
- æœºå™¨å­¦ä¹ ï¼šLRã€RF + (TF-IDF + æ–‡æœ¬æ¥æºå‘é‡)  
- æ·±åº¦å­¦ä¹ ï¼šFinBERTã€ MTL-FinBERT(Ours)  

<img src="images/ch/æ¦‚å¿µæµç¨‹å›¾.png" alt="æ¦‚å¿µæµç¨‹å›¾" width="1000"/>
<img src="images/ch/æŠ€æœ¯æµç¨‹å›¾.png" alt="æŠ€æœ¯æµç¨‹å›¾" width="1000"/>
---
## ğŸš€ å¿«é€Ÿå¼€å§‹

### é…ç½®ç¯å¢ƒ
```bash
pip install -r requirements.txt
```

### è¿è¡Œ
A: æƒ…ç»ªæµ‹åº¦
```
# è¯å…¸æ³•
python A_Emo_Measure/Emo-Dict/EmoMeasure.py # è‡ªåŠ¨éå†è¿è¡Œä¸‰ä¸ªå­—å…¸

# æœºå™¨å­¦ä¹ æ³•
python A_Emo_Measure/Machine-learning/LR/train.py # çº¿æ€§å›å½’è®­ç»ƒ
python A_Emo_Measure/Machine-learning/LR/predict.py # çº¿æ€§å›å½’æƒ…ç»ªæµ‹åº¦

python A_Emo_Measure/Machine-learning/RF/train.py # éšæœºæ£®æ—è®­ç»ƒ
python A_Emo_Measure/Machine-learning/RF/predict.py # éšæœºæ£®æ—æƒ…ç»ªæµ‹åº¦

# æ·±åº¦å­¦ä¹ æ³•
python A_Emo_Measure/Deep-learning/A_Pre_Train/Simple-Task-Model/A_Pre_Train/PreTrain.py # FinBERT è¿›ä¸€æ­¥é¢„è®­ç»ƒ
python A_Emo_Measure/Deep-learning/A_Pre_Train/Multi-Task-Model/A_Pre_Train/PreTrain.py # FinBERT è¿›ä¸€æ­¥é¢„è®­ç»ƒ(ä¸ä¸ŠåŒï¼Œä»»é€‰ä¸€å³å¯)

python A_Emo_Measure/Deep-learning/A_Pre_Train/Simple-Task-Model/B_Fine_Tuning/train.py # FinBERT ç›‘ç£å¾®è°ƒ
python A_Emo_Measure/Deep-learning/A_Pre_Train/Simple-Task-Model/B_Fine_Tuning/eval.py # FinBERT æƒ…ç»ªæµ‹åº¦

python A_Emo_Measure/Deep-learning/A_Pre_Train/Multi-Task-Model/B_Fine_Tuning/train.py # MTL-FinBERT ç›‘ç£å¾®è°ƒ
python A_Emo_Measure/Deep-learning/A_Pre_Train/Multi-Task-Model/B_Fine_Tuning/eval.py # MTL-FinBERT æƒ…ç»ªæµ‹åº¦
```
B: æµ‹åº¦ç»“æœæ£€éªŒ
```
python B_Result_Analysis/evaluate_models_every_day.py # æŒ‰æ¯å¤©ç»¼åˆæƒ…ç»ªè¿›è¡Œè¯¯å·®æ£€éªŒ
python B_Result_Analysis/evaluate_models_every_texts.py # æŒ‰æ¯æ¡æ–‡æœ¬æƒ…ç»ªè¿›è¡Œè¯¯å·®æ£€éªŒ
```
C: å®è¯åˆ†æ ä¸ D: æŠ•èµ„ç»„åˆ å¤šä¸ºipynbæ–‡ä»¶ï¼Œåœ¨jupyterä¸‹è¿è¡Œ  

---
## ğŸ“‚ é¡¹ç›®ç»“æ„

```
Multi-Task-Learning/
â”œâ”€â”€ A_Emo_Measure/                 # æƒ…ç»ªæµ‹åº¦æ¨¡å—
â”‚   â”œâ”€â”€ bert-base-chinese/         # BERTä¸­æ–‡é¢„è®­ç»ƒæ¨¡å‹
â”‚   â”œâ”€â”€ data/                      # æƒ…ç»ªæ¨¡å‹è®­ç»ƒæ•°æ®ä¸é¢„æµ‹æ•°æ®ï¼ˆåç»­å‡é‡‡ç”¨æ‚²è§‚ä¼°è®¡ç»“æœï¼‰(Input)
â”‚   â”œâ”€â”€ Deep-learning/                  # æ·±åº¦å­¦ä¹ æ¨¡å—
â”‚   â”‚    â”œâ”€â”€ Multi-Task-Model/          # å¤šä»»åŠ¡å­¦ä¹ æ¨¡å‹ <----Ours
â”‚   â”‚    â”‚    â”œâ”€â”€ A_Pre_Train/            # é¢„è®­ç»ƒæ¨¡å—
â”‚   â”‚    â”‚    â”œâ”€â”€ B_Fine_Tuning/          # å¾®è°ƒæ¨¡å—
â”‚   â”‚    â”‚    â”œâ”€â”€ loss/                   # æŸå¤±è®°å½•(Output)
â”‚   â”‚    â”‚    â”œâ”€â”€ model/                  # æƒé‡ä¿å­˜(Output)
â”‚   â”‚    â”‚    â””â”€â”€ results/                # ç»“æœè¾“å‡º(Output)
â”‚   â”‚    â””â”€â”€ Simple-Task-Model/         # å•ä»»åŠ¡å­¦ä¹ æ¨¡å‹
â”‚   â”œâ”€â”€ Emo-Dict/                       # æƒ…ç»ªè¯å…¸æ¨¡å—
â”‚   â”‚    â”œâ”€â”€ Bian/                      # ä¸Šæµ·è´¢ç»å¤§å­¦åä¸–åšç­‰å¼€å‘çš„ä¸­æ–‡è´¢ç»é¢†åŸŸæƒ…ç»ªè¯å…¸(åç­‰ï¼Œ2019)
â”‚   â”‚    â”œâ”€â”€ DLUT/                      # å¤§è¿ç†å·¥å¤§å­¦æƒ…æ„Ÿè¯å…¸(DLUT)
â”‚   â”‚    â”œâ”€â”€ Jiang/                     # ä¸­å¤®è´¢ç»å¤§å­¦å§œå¯Œä¼Ÿç­‰å¼€å‘çš„ä¸­æ–‡é‡‘èæ–‡æœ¬æƒ…ç»ªè¯å…¸(å§œå¯Œä¼Ÿç­‰ï¼Œ2021)
â”‚   â”‚    â”œâ”€â”€ EmoMeasure.py              # è¯å…¸æ³•æƒ…ç»ªæµ‹åº¦ä¸»ç¨‹åº
â”‚   â”‚    â”œâ”€â”€ utils.py                   # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ Machine-learning/               # æœºå™¨å­¦ä¹ æ¨¡å—
â”‚        â”œâ”€â”€ LR/                        # é€»è¾‘å›å½’
â”‚        â””â”€â”€ RF/                        # éšæœºæ£®æ—
â”‚
â”œâ”€â”€ B_Result_Analysis/                 # ç»“æœåˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ evaluate_models_every_day.py   # æŒ‰æ¯å¤©ç»¼åˆæƒ…ç»ªè¿›è¡Œè¯¯å·®æ£€éªŒ
â”‚   â”œâ”€â”€ evaluate_models_every_texts.py # æŒ‰æ¯æ¡æ–‡æœ¬æƒ…ç»ªè¿›è¡Œè¯¯å·®æ£€éªŒ
â”‚   â”œâ”€â”€ evaluation/                    # è¯„ä¼°æŒ‡æ ‡å­˜æ”¾(Output)
â”‚   â””â”€â”€ Measurement_Result/            # ä¸‰ç±»æ¨¡å‹çš„æƒ…ç»ªæµ‹åº¦ç»“æœ(Input)
â”‚
â”œâ”€â”€ C_Empirical_Analysis/          # å®è¯åˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ data/                      # å®è¯æ‰€éœ€æ•°æ®(Input)
â”‚   â”‚    â”œâ”€â”€ Emo_data              # æ–‡æœ¬æƒ…ç»ªæ•°æ®
â”‚   â”‚    â”œâ”€â”€ Financial_data        # é‡‘èç»æµæ•°æ®
â”‚   â”œâ”€â”€ Data_Mine/                 # æ•°æ®æŒ–æ˜â€”â€”æå–æƒ…ç»ªç»“æœçš„ç»“æ„ä¿¡æ¯
â”‚   â””â”€â”€ Statistical_test/          # ç»Ÿè®¡æ£€éªŒâ€”â€”å››ç±»å®è§‚ç»æµå˜é‡ç»Ÿè®¡æ£€éªŒ
â”‚
â””â”€â”€ D_Investment_Portfolio/        # æŠ•èµ„ç»„åˆæ¨¡å—
    â”œâ”€â”€ data/                      # æŠ•èµ„æ‰€éœ€æ•°æ®(Input)
    â”œâ”€â”€ Emotion_Extraction/        # ä¸ªè‚¡æƒ…ç»ªæµ‹åº¦â€”â€”æ·±åº¦è¿ç§»å­¦ä¹ 
    â””â”€â”€ Investment_portfolio/      # ä¸ªè‚¡å®è¯åˆ†æä¸ä¸æŠ•èµ„ç»„åˆç­–ç•¥
```
---

## ğŸ“Š æ•°æ®ä»‹ç»

æœ¬é¡¹ç›®ä¸­çš„æƒ…ç»ªæ–‡æœ¬æ•°æ®å…±åˆ†ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯å¤§ç›˜å®è§‚æ•°æ®é›†ï¼ŒåŒ…å«å¸‚åœºæ•´ä½“çš„è‚¡å§æƒ…ç»ªæ–‡æœ¬ä¸å¾®åšæƒ…ç»ªæ–‡æœ¬ï¼›  
å¦ä¸€ç±»æ˜¯è¯åˆ¸å…³è”æ•°æ®é›†ï¼Œä¸ºä¸ªè‚¡å¯¹åº”çš„æƒ…ç»ªæ–‡æœ¬æ•°æ®ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

### å¤§ç›˜å®è§‚æ•°æ®é›†:
{
    "date": "2015-03-16",                # æ—¥æœŸ (å­—ç¬¦ä¸²)
    "index": [2.2649, 2.4329, 3.5572],    # æŒ‡æ ‡å‘é‡ (ç¤ºä¾‹ä¸ºä¸‰ç»´æµ®ç‚¹æ•°å‘é‡)
    "guba_data": ["text1", "text2", ...],   # è‚¡å§æƒ…ç»ªæ–‡æœ¬åˆ—è¡¨
    "weibo_data": ["text1", "text2", ...]   # å¾®åšæƒ…ç»ªæ–‡æœ¬åˆ—è¡¨
}

- `date` ï¼šæ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°æ—¥  
- `index` ï¼šå›å½’æ ‡ç­¾ï¼ˆå¤§ç›˜æŒ‡æ•°æ”¶ç›Šç‡ï¼‰
- `guba_data` ï¼šæ¥æºäºè‚¡å§çš„ç”¨æˆ·æ–‡æœ¬é›†åˆ  
- `weibo_data` ï¼šæ¥æºäºå¾®åšçš„ç”¨æˆ·æ–‡æœ¬é›†åˆ

å…¶ä¸­ï¼Œæ¯ä¸€æ¡ JSON åˆ—è¡¨å…ƒç´ å¯ä»¥çœ‹ä½œä¸€å¤©çš„æ•°æ®å¿«ç…§ï¼ŒåŒ…å«è¯¥æ—¥çš„æƒ…ç»ªæ ‡ç­¾åŠå¯¹åº”çš„å¤šæ¡ç¤¾äº¤åª’ä½“æ–‡æœ¬ã€‚  
åç»­æ¨¡å‹å°†åŸºäºè¿™äº›æ•°æ®è¿›è¡Œå¤šä»»åŠ¡å¤šæ ‡ç­¾çš„æƒ…ç»ªå›å½’ã€‚

### è¯åˆ¸å…³è”æ•°æ®é›†:  
è¯åˆ¸çº§åˆ«çš„æƒ…ç»ªæ•°æ®ä»¥ CSV æ ¼å¼å­˜å‚¨ï¼Œä¸»è¦å­—æ®µç¤ºä¾‹å¦‚ä¸‹ï¼š

| å­—æ®µ       | è¯´æ˜                                  | ç¤ºä¾‹                      |
|------------|---------------------------------------|---------------------------|
| é˜…è¯»æ•°     | è¯¥æ¡æ–‡æœ¬è¢«é˜…è¯»çš„æ¬¡æ•°                  | 568                       |
| è¯„è®ºæ•°     | è¯¥æ¡æ–‡æœ¬ä¸‹çš„è¯„è®ºæ•°                    | 1                         |
| æ–‡æœ¬       | ç”¨æˆ·å‘å¸ƒçš„æƒ…ç»ªæ–‡æœ¬                    | æµ…è°ˆä»·å€¼æŠ•èµ„ä¸æŠ•æœº        |
| å‘å¸ƒè€…     | ç”¨æˆ·å                                | è·Œå…¥æˆ‘å¿ƒ                  |
| æœˆä»½       | å‘å¸ƒæ—¶é—´çš„æœˆä»½ï¼ˆä¾¿äºå­£èŠ‚æ€§åˆ†æï¼‰       | 12                        |
| æ—¥æœŸ       | å‘å¸ƒæ—¶é—´ï¼ˆç²¾ç¡®åˆ°æ—¥ï¼‰                   | 2024-12-29                |

ç¤ºä¾‹æ•°æ®ï¼š
é˜…è¯»æ•°,è¯„è®ºæ•°,æ–‡æœ¬,å‘å¸ƒè€…,æœˆä»½,æ—¥æœŸ
568, 1, æµ…è°ˆä»·å€¼æŠ•èµ„ä¸æŠ•æœº, Anonymous, 12, 2024-12-29  
1432, 7, èåˆ›å¢ƒå†…å€ºäºŒæ¬¡é‡ç»„ï¼Œæ­¤è½®åå•†éš¾åº¦æ›´å¤§, Anonymous, 11, 2024-11-17  
1749, 11, å¸‚å€¼ç®¡ç†åˆ©å¥½èƒ½ä¸èƒ½ç»™ä¸‡ç§‘è‚¡ä»·è¿è¡Œå¸¦æ¥æ”¹å–„, Anonymous, 11, 2024-11-16  
274,0, æˆ¿ä¼ç»§ç»­ä»¥ä»·æ¢é‡ä»Šå¹´10æœˆï¼Œä¸‡ç§‘å®ç°åˆåŒé”€å”®é¢ç§¯143.9ä¸‡å¹³æ–¹ç±³ï¼ŒåˆåŒé”€å”®é‡‘é¢, Anonymous, 11, 2024-11-13  

è¯¥æ•°æ®é›†å¯ç”¨äºå¯¹ä¸ªè‚¡æˆ–è¡Œä¸šå±‚é¢çš„æƒ…ç»ªä¿¡æ¯æå–ï¼Œç»“åˆè‚¡ç¥¨ä»£ç åŠäº¤æ˜“æ•°æ®ï¼Œå®ç°ç»†ç²’åº¦çš„æŠ•èµ„ç»„åˆç ”ç©¶æˆ–å¤šä»»åŠ¡é¢„æµ‹ã€‚ 
